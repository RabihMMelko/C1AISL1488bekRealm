<!DOCTYPE html>
<meta charset="utf-8">
<html>
<body>
<h1>Tomcat Realm</h1>

<h2> Contenu: </h2>
<ol>
<li>Introduction: le Quoi</li>
<li>Types de Plugins</li>
<li>Configuration Generale d'un Realm</li>
<li>Fonctionnalités Communes</li>
<li>Application: Implémenter un Realm Personnalisé dans Tomcat</li>
</ol>

<h2>Introduction: le Quoi</h2>
<p>Tomcat Realm est une interface permettant de gérer l'authentification du coté application, à travers une connection entre Catalina et une base de données contenant les informations utilisateurs, mots de passe, ...</p>

<p>En d'autres termes, c'est une sorte de base de données des utilisateurs et mots de passe permettant d'identifier les utilisateurs ayant accès à une application Web (ou plusieurs), ainsi qu'une énumeration des roles associés à ces utilisateurs.<br>
Le système de roles est analogue aux <i>groupes</i> dans les systèmes Unix, car l'accès est donné pour tous les utilisateurs d'un role donné. Un utilisateur peut posséder plusieurs roles.</p>
<p>La specification <em>Servlet</em> decrit un mécanisme portable permettant aux applications de &quot;déclarer&quot; leur options de sécurité. Cependant, aucune IPA ne definit l'interface entre le conteneur <em>Servlet</em> et l'utilisateur associé.<br>
Comme il est désirable de connecter la <em>Servlet</em> à une base de données pour l'authentification (ou tout autre mécanisme existant sur l'environnement), Tomcat definit une interface Java <strong>org.apache.catalina.Realm</strong>, pouvant être implémentée par des composants &quot;plug in&quot; pour établir cette connection</p>
<h2> Types de Plugins </h2>
<p>Six plug-ins standards sont disponibles:</p>
<p>
<ul>
<li><u><b>JDBCRealm</b></u>:<p> Dérivé de l'interface Realm de Tomcat, la recherche des utilisateurs, roles et mots de passe se fait lors d'une connection entre Catalina et une BD relationnelle, en utilisant un driver JDBC (tel MySQL Connector).</p>
  <p>Les modifications sur la BD sont immédiates, permettant de maintenir des authentifications actualisées.</p>
  <p>Quand un utilisateur accède pourla première fois à une ressource protégée, Tomcat appelle la méthode authenticate(), afin que toute actualisation soit immédiatement reflétée. L'authentification de cet utilisateur sera mise en cache sur la durée de la session.</p>
  <p>La flexibilité de configuration permet de l'adapter en fonction du modèle sur la base de donnée, tout en respectant les critères suivants:</p>
<br>
<ul>
<li> La table 'users' contient au moins deux attributs: Nom Utilisateur et Mot de Passe.</li>
<li>La table des roles utilisateurs doit contenir des roles valides lié aux utilisateurs.</li>
</ul></li></p>
</li>
<li><u><b>DataSourceRealm</b></u>:<p> Similaire à JDBCRealm dans l'appartenance à l'interface Realm de Tomcat, la connection est effectuée via JNDI. Cette implémentation est avantageuse car JDBCRealm ne permet que de se connecter à une seule BD, soit une authentification à la fois. DataSourceRealm, quant à elle, permet plusieurs authentification simultanées par regroupement de connexions.</li></p>
<li><u>JNDIRealm</u> - L'information est stockée sur un serveur LDAP, accédée par le biais de JNDI.</li>
<li><u>UserDatabaseRealm</u> - L'information est stockée dans une ressource UserDatabase JNDI, typiquement dans un document XML (conf/tomcat-users.xml).</li>
<li><u>MemoryRealm</u> - Une collection est initialisée dans un objet mémoire à travers un fichier XML (conf/tomcat-users.xml)</li>
<li>
<u>
JAASRealm
</u>
 - L'accès à l'information est effectué à travers le framework <i> Java Authentication &amp; Authorization Service (JAAS) </i>
</li>
</ul>
Il est aussi possible de créer sa propre implémentation <u> Realm </u> et de l'intégrer avec Tomcat. Pour cela, il faut:
</p>
<br>
<ol>
<li> Implémenter <b>org.apache.catalina.Realm</b></li>
<li>Placer ce Realm dans <b>$CATALINA_HOME/lib</b></li>
<li>Déclarer le Realm</li>
</ol>
<h2>Configuration Generale d'un Realm</h2>
<p> En général, un Realm est configuré еn ajoutant au fichier <b>conf/server.xml</b> un élément sous la forme:
<div style = 'background-color:#a2a2dc'>

&lt;Realm className="...nom de classe de l'implémentation"<br> ...autres attributs.../&gt;

</div>
<p> La position du Realm permet de définir sa visibilité:
<ul>
<li><i>Dans &lt;Engine&gt;</i>- Le Realm est partagé pour toutes les applications sur tous les hôtes, sauf si défini explicitement dans un élément <i>&lt;Host&gt;</i> ou <i>&lt;Context&gt;</i></li>
</ul>
</body>
</html>